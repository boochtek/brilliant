require "rattler"

parser Brilliant::Parser < Rattler::Runtime::ExtendedPackratParser

%start program

%whitespace ( SPACE+ / comment)* {
    program             <- expression+ EOF                                          <AST::Program.new>
    expression          <- literal / function_call
    function_call       <- identifier ~'(' arg_list ~')'                            <AST::FunctionCall.new>
    identifier          <- @( ( ALPHA / '_' ) ( WORD / '!' / '?' )* )
    arg_list            <- ( expression? / expression ',' arg_list )
    literal             <- literal_text / literal_integer
    literal_text        <- @( quoted_text )                                         <AST::LiteralText.new>
    literal_integer     <- @DIGIT+                                                  <AST::LiteralInteger.new>
    quoted_text         <- ~'"' ( !'"' . )* ~'"'
}
comment                 <- ~([#] [^\n]*)
